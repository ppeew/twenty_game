游戏介绍：

# snatch_card
snatch_card game
使用flutter开发

## 介绍

简介： 该游戏是一个抢牌游戏，玩家需要在限定的回合内尽可能多的凑齐能够组成总和为12的卡牌堆，凑齐即可加分，
其中游戏中会有4种特殊卡， 比如:

- 红色炸弹卡（可以炸掉其他玩家卡堆里的一张卡），

- 黄色万能卡（任意选一张数字类型卡加入自己卡堆），

- 绿色交换卡（可以用自己一张卡与其他玩家交换），

- 蓝色修改卡（修改一张自己或者他人的数字类型卡）。

卡牌使用方法，玩家可以在游戏中探索。全部回合结束后，根据玩家分数总和计算排名

#### 玩家卡牌堆的牌会被删除，满足其一：

#### 1) 当每一次取到的卡牌放入卡牌堆总和恰好为12时，分数+10，清空卡堆,不清空特殊卡

#### 2) 当取到的卡牌放入卡牌堆，总和大于12，此时不加分数，清空卡堆

#### 3) 当玩家的卡堆大于6张，则会先删除之前抢的卡，直到卡牌不超过6张

[//]: # (游戏已部署，访问: 8.134.163.22:8001)

## 游戏流程

1 发牌阶段

随机生成卡牌，用户数+2张，特殊卡小于等于1张，其余全是普通卡，普通卡点数1-9.
发牌之后直接进入抢牌阶段

2 抢牌阶段

用户看手速抢牌，只能拿1张牌或不拿。计时6-8s

3 出牌阶段

只能用特殊卡，计时6-18s

4 结束阶段

每个回合计算用户得分,睡眠一会，然后进入下一轮发牌，直到回合数用完

5 结算游戏

游戏结束，计算排名，分发奖励

## task

- [] 路由
- [] 画出静态页面
- [] 完善动态功能
- [] 随机生成数据模拟
- [] 添加网络请求，建立websocket


## 分布式难点（跨IP服务调用）

- 购买商城系统物品：

1）扣减商城物品库存（本地调用，用mysql的回滚）

2）扣减用户金币（跨服务，失败可能是金币不够，也可能是网络问题导致其实已经成功扣减，回滚用消息队列MQ，保证金币一定增加回来！这块要设置幂等性，因为是可能重复的）

3）然后增加用户商品（跨服务）（该操作一定成功，消息队列MQ）

- 购买交易系统商品：

1）锁定交易商品（本地）

2）扣减购买者金币（跨服务）

3）增加售卖者金币+增加购买者物品表（MQ一致性） 12要设计回滚方案，幂等性保证